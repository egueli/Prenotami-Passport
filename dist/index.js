"use strict";Object.defineProperty(exports,"__esModule",{value:true});const _playwright=require("playwright");const _goToLoginPage=require("./functions/goToLoginPage");const _userLogin=require("./functions/userLogin");const _passport=require("./functions/passport");const _promises=_interopRequireDefault(require("fs/promises"));const _telegram=require("./services/telegram");const _telegramUsers=require("./services/telegramUsers");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}const auth=async page=>{await (0,_goToLoginPage.goToLoginPage)(page);await (0,_userLogin.userLogin)(page)};(async()=>{setInterval(async()=>{for(const userId of _telegramUsers.telegramUsers){await _telegram.bot.telegram.sendMessage(userId,"App running").catch()}},1e3*60*60);try{const browser=await _playwright.webkit.launch({headless:true});const page=await browser.newPage();await auth(page);let loop=true;do{try{const isAvailable=await (0,_passport.passportAppointmentIsAvailable)(page);if(isAvailable){for(const userId of _telegramUsers.telegramUsers){await _telegram.bot.telegram.sendMessage(userId,"Prenotami Agendamento do passporte dispon\xedvel");const pageContent=await page.content();await _promises.default.writeFile("passportPage.pdf",pageContent);await _telegram.bot.telegram.sendDocument(userId,"../passportPage.pdf")}}loop=!isAvailable}catch(error){for(const userId1 of _telegramUsers.telegramUsers){await _telegram.bot.telegram.sendMessage(userId1,error.message)}await auth(page)}}while(loop)await browser.close()}catch(error1){for(const userId2 of _telegramUsers.telegramUsers){await _telegram.bot.telegram.sendMessage(userId2,error1.message)}}})();